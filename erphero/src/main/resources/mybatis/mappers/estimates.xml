<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.erphero.dao.EstimateDao">
	<insert id="insertEstimate" parameterType="com.erphero.vo.Estimate">
		<selectKey keyProperty="code" resultType="string" order="BEFORE">
			select 'ES' || to_char(sysdate, 'yy')|| lpad(HERO_ESTIMATES_seq.nextval,4,0) as estimate_code from dual
		</selectKey>
			insert into hero_estimates
			(estimate_code, estimate_vender_code, estimate_req_name)
			values
			( #{code}, 
				(select
	        	vender_code
	        	from hero_venders
	        	where vender_reg_num = #{venderCode}), #{reqName})
	</insert>
	
	

</mapper>